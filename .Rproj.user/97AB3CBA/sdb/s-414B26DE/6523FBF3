{
    "contents" : "Outliers\n========================================================\n\n## In-Class Exercise #50\n\nAlalyze exam data. Find outliers. \n\n### Read data\n\n```{r}\nsetwd(\"./data\")\nexams<-read.csv(\"exams_and_names-2.csv\",header=T)\nsetwd(\"../\")\n```\n\n### Using boxplot w/ interquartile range\n\nKey is using measure which is natural to the data set e.g., quartiles on distribution. Recall:\n- Box goes to 25% (Q1) and 75% (Q3)\n- Whiskers go to 1.5x Q1-Q3 range\n- Beyond that are outliers\n\n```{r fig.width=7, fig.height=6}\nwith(exams,plot(Exam.1~Exam.2))\n\npar(mfrow=c(1,2))\nwith(exams,boxplot(Exam.1)) # no outliers\nwith(exams,boxplot(Exam.2)) # three outliers\n\npar(mfrow=c(1,1))\nboxplot(exams$Exam.1,exams$Exam.2,col=\"blue\",main=\"Exam Scores\",\n        names=c(\"exam1\", \"exam2\"),ylab=\"Exam Score\")\n```\n\n### Using z score\n\n```{r}\nsd1<-sd(exams$Exam.1,na.rm=T)\nsd2<-sd(exams$Exam.2,na.rm=T)\n\nexams$Exam.1.z<-(exams$Exam.1-mean(exams$Exam.1,na.rm=T))/sd1\nexams$Exam.2.z<-(exams$Exam.2-mean(exams$Exam.2,na.rm=T))/sd2\n\n# Note: default for scale is to set na.rm=T\nexams$Exam.1.scale<-scale(exams$Exam.1)\nexams$Exam.2.scale<-scale(exams$Exam.2)\n\nhead(sort(exams$Exam.2.z))\nhead(sort(exams$Exam.2.z,decreasing=T))\n     \n# No outliers\n```\n\n## In-Class Exercise #52\n\nAlalyze exam data. Find outliers using IQR. **Considered better than mean/sd as they are sensitive to outliers.**\n\n### Calculating / using IQR\n\n```{r}\n# 1. get 1st and 3rd quantiles\nq1<-quantile(exams$Exam.2,0.25,na.rm=T)\nq3<-quantile(exams$Exam.2,0.75,na.rm=T)\n\n# 2. calc iqr\niqr<-q3-q1\n\n# 3. find outliers\noutliers<-exams[exams$Exam.2>=q3+(1.5*iqr) | exams$Exam.2<=q1-(1.5*iqr),]\noutliers\n# 3 outliers\n\n```\n\n### Example of why iqr better: outliers skew mean/sd\n\n```{r}\ndata<-c(1,2,3,4,100)\nboxplot(data)\n# shows outliers\n\nsd3<-sd(data)\nmean1<-mean(data)\nzscores<-(data-mean1)/sd3\nzscores\n# no outliers\n```\n\n### iqr not perfect. some distributions are broad\n\n```{r}\n# example: T distribution w/ low degrees of freedom. It's just the distribution.\nboxplot(rt(50,df=1))\n```\n\n## Detecting outliers for multiple attributes\n\n### In-class #52: Using regression\n\nFirst use basic lm to plot regression line for the data.\n\n```{r}\n# load/clean data\nsetwd(\"./data\")\nexams<-read.csv(\"exams_and_names-2.csv\",header=T)\nsetwd(\"../\")\nexams1<-exams[!is.na(exams[,3]),]\n\n# fit model\nfit<-lm(exams$Exam.2~exams$Exam.1)\nsummary(fit)\n\n# plot results\nplot(exams$Exam.1,exams$Exam.2,pch=19,xlab=\"Exam 1\", ylab=\"Exam 2\", xlim=c(100,200),\n     ylim=c(100,200))\nabline(fit)\n\n# inspect residuals\nsort(fit$residuals)\n# recall that residuals are the **vertical** distance to the regression (fitted values) line. \n```\n\nNow let's look at it scaling the dots by the size of their residual\n\n```{r}\n# load/clean data\nsetwd(\"./data\")\nexams<-read.csv(\"exams_and_names-2.csv\",header=T)\nsetwd(\"../\")\nexams1<-exams[!is.na(exams[,3]),]\n\n# fit model\nfit2<-lm(exams1$Exam.2~exams1$Exam.1)\n\n# plot results\nplot(exams$Exam.1,exams$Exam.2,pch=19,xlab=\"Exam 1\", ylab=\"Exam 2\", xlim=c(100,200),\n     ylim=c(100,200),cex=abs(fit2$residuals)/10)\n\nabline(fit2)\n\nplot(fit2) # if you tell R to plot a model, it takes you through a series of graphs.\n```\n\n### In-class #53: Using Clustering w/ Kmeans\n\nFirst cluster the data\n\n```{r}\n# load data\nsetwd(\"./data\")\ndata<-read.csv(\"exams_and_names-2.csv\",header=T)\nsetwd(\"../\")\n\n# clean data taking only needed rows\nx<-data[!is.na(data[,3]),2:3]\n\n# plot the data\nplot(x,pch=19,xlab=\"Exam 1\", ylab=\"Exam 2\")\n\n# fit model\nfit<-kmeans(x,5)\n\n# plot results\npoints(fit$centers,pch=19,col=\"blue\",cex=2)\npoints(x,col=fit$cluster,pch=19)\n\n```\n\nDifferent methods end up w/ different outliers. In this case, the lower three are considered outliers b/c they have their own cluster (whenk K is 5). The upper two are not as they fall w/in the range of the others when k=5. ",
    "created" : 1407690140795.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2542075222",
    "id" : "6523FBF3",
    "lastKnownWriteTime" : 1407701457,
    "path" : "~/stats202lectureR/outliers.Rmd",
    "project_path" : "outliers.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}